@using AdminMnsV1.Models;
@using AdminMnsV1.Models.ViewModels;
@using AdminMnsV1.Models.Candidature;
@model AdminMnsV1.Models.ViewModels.CreateCandidatureViewModel

@{
	ViewData["Title"] = "Dossiers";
}

<h1 class="mx-4 mt-5">Dossiers</h1>

<div class="graphs">
	<div class="graphFileClass m-4 border rounded-4 bg-light">
		<div class="title">
			<h2 class="mt-5 mx-4 text-center">Visualisation des dossiers</h2>
		</div>
		<div class="barFile w-75 mx-auto">
			<canvas id="fileClass" aria-label="chart" role="img"></canvas>
		</div>
	</div>
</div>

---

<div class="btnNewDossier">
	<button type="button" class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#newDossierModal">
		<img width="20" height="20" src="https://img.icons8.com/ios/50/plus--v1.png" alt="plus--v1" /> Nouveau Dossier
	</button>
</div>

<div class="modal fade" id="newDossierModal" tabindex="-1" aria-labelledby="newDossierModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="newDossierModalLabel">Créer un Nouveau Dossier de Candidature</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<form id="createDossierForm" method="post" asp-controller="Candidatures" asp-action="CreateCandidature">
				@Html.AntiForgeryToken()
				<div class="modal-body">
					<div asp-validation-summary="ModelOnly" class="text-danger"></div>

					<div class="mb-3">
						<label for="studentLastName" class="form-label">Nom du Candidat</label>
						<input type="text" class="form-control" id="studentLastName" asp-for="LastName" required>
						<span asp-validation-for="LastName" class="text-danger"></span>
					</div>
					<div class="mb-3">
						<label for="studentFirstName" class="form-label">Prénom du Candidat</label>
						<input type="text" class="form-control" id="studentFirstName" asp-for="FirstName" required>
						<span asp-validation-for="FirstName" class="text-danger"></span>
					</div>
					<div class="mb-3">
						<label for="studentEmail" class="form-label">Email du Candidat</label>
						<input type="email" class="form-control" id="studentEmail" asp-for="Email" required>
						<span asp-validation-for="Email" class="text-danger"></span>
					</div>
					<div class="mb-3">
						<label for="studentPhoneNumber" class="form-label">Téléphone du Candidat</label>
						<input type="tel" class="form-control" id="studentPhoneNumber" asp-for="PhoneNumber">
						<span asp-validation-for="PhoneNumber" class="text-danger"></span>
					</div>
					<div class="mb-3">
						<label for="studentBirthDate" class="form-label">Date de naissance</label>
						<input type="date" class="form-control" id="studentBirthDate" asp-for="BirthDate">
						<span asp-validation-for="BirthDate" class="text-danger"></span>
					</div>

					<div class="mb-3">
						<label for="classId" class="form-label">Sélectionner la Classe</label>
						<select class="form-select" id="classId" asp-for="ClassId"
								asp-items="Model.AvailableClasses">
							<option value="">Sélectionner une classe</option>
						</select>
						<span asp-validation-for="ClassId" class="text-danger"></span>
					</div>

					<div class="mb-3">
						<label class="form-label">Documents requis pour ce dossier :</label>
						<div id="documentTypesCheckboxes" class="border p-3 rounded">
							@if (Model.AllAvailableDocumentTypes != null && Model.AllAvailableDocumentTypes.Any())
							{
								foreach (var docType in Model.AllAvailableDocumentTypes)
								{
									<div class="form-check">
										<input class="form-check-input" type="checkbox"
											   value="@docType.DocumentTypeId"
											   id="docType_@docType.DocumentTypeId"
											   name="SelectedDocumentTypeIds"
										@(Model.SelectedDocumentTypeIds != null && Model.SelectedDocumentTypeIds.Contains(docType.DocumentTypeId) ? "checked" : "")>
										<label class="form-check-label" for="docType_@docType.DocumentTypeId">
											@docType.NameDocumentType
										</label>
									</div>
								}
							}
							else
							{
								<p class="text-muted">Aucun type de document disponible.</p>
							}
						</div>
					</div>

				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
					<button type="submit" class="btn btn-primary">Créer le Dossier et Envoyer l'Email</button>
				</div>
			</form>
		</div>
	</div>
</div>

---

<div class="accordion" id="accordionPanelsStayOpenExample">
	<div class="accordion-item">
		<h2 class="accordion-header bob">
			<button class="accordion-button" type="button" data-bs-toggle="collapse"
					data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true"
					aria-controls="panelsStayOpen-collapseOne">
				Dossiers en cours
			</button>
		</h2>
		<div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show">
			<div class="accordion-body">
				<div class="tableProfessors">
					<table class="table align-middle table-striped table-hover table-custom bg-secondary table-responsive">
						<thead>
							<tr>
								<th scope="col">#</th>
								<th scope="col">Nom</th>
								<th scope="col">Prénom</th>
								<th scope="col" class="d-none d-sm-table-cell">Classe</th>
								<th scope="col" class="d-none d-md-table-cell">Date de Création</th>
								<th scope="col">Action</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th scope="row">1</th>
								<td>Hatake</td>
								<td>Looka</td>
								<td class="d-none d-sm-table-cell">2-A</td>
								<td class="d-none d-md-table-cell">2015-09-01</td>
								<td><button class="btn btn-primary"> <a href="@Url.Action("CandidatureStudent", "CandidaturesStudents")">Voir</a></button></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<div class="accordion-item">
		<h2 class="accordion-header">
			<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
					data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false"
					aria-controls="panelsStayOpen-collapseTwo">
				Dossiers validés
			</button>
		</h2>
		<div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse">
			<div class="accordion-body">
				<div class="tableProfessors">
					<table class="table align-middle table-striped table-hover table-custom bg-secondary table-responsive">
						<thead>
							<tr>
								<th scope="col">#</th>
								<th scope="col">Nom</th>
								<th scope="col">Prénom</th>
								<th scope="col" class="d-none d-sm-table-cell">Classe</th>
								<th scope="col" class="d-none d-md-table-cell">Ville</th>
								<th scope="col" class="d-none d-lg-table-cell">Date Inscription</th>
								<th scope="col" class="d-none d-md-table-cell">Date de Création</th>
								<th scope="col">Action</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th scope="row">1</th>
								<td>Aizawa</td>
								<td>Shota</td>
								<td class="d-none d-sm-table-cell">2-A</td>
								<td class="d-none d-md-table-cell">Musutafu</td>
								<td class="d-none d-lg-table-cell">2015-09-01</td>
								<td class="d-none d-lg-table-cell">Actif</td>
								<td><button class="btn btn-primary">Voir</button></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<div class="accordion-item">
		<h2 class="accordion-header">
			<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
					data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false"
					aria-controls="panelsStayOpen-collapseThree">
				Dossiers refusés
			</button>
		</h2>
		<div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
			<div class="accordion-body">
				<strong>This is the third item's accordion body.</strong> It is hidden by default, until the
				collapse plugin adds the appropriate classes that we use to style each element. These
				classes
				control the overall appearance, as well as the showing and hiding via CSS transitions. You
				can
				modify any of this with custom CSS or overriding our default variables. It's also worth
				noting
				that just about any HTML can go within the <code>.accordion-body</code>, though the
				transition
				does limit overflow.
			</div>
		</div>
	</div>
</div>

---

@Html.Partial("~/Views/Shared/Components/_Footer.cshtml")

@section Scripts {
	<partial name="_ValidationScriptsPartial" />
}